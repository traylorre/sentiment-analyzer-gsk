# Implementation Plan: Delete Cookies.ts Security Fix

**Branch**: `1145-delete-cookies-ts` | **Date**: 2026-01-05 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/1145-delete-cookies-ts/spec.md`

## Summary

Delete the `frontend/src/lib/cookies.ts` file and its test file to eliminate CVSS 8.6 XSS vulnerability where authentication tokens are stored in JavaScript-accessible cookies. Update dependent file (auth-store.ts) to remove imports and calls to deleted functions.

## Technical Context

**Language/Version**: TypeScript 5.x (Next.js frontend)
**Primary Dependencies**: Next.js, Zustand (state management)
**Storage**: N/A (removing storage mechanism)
**Testing**: Jest/Vitest for frontend unit tests
**Target Platform**: Web browser (Next.js application)
**Project Type**: Web application (frontend component)
**Performance Goals**: N/A (deletion reduces code)
**Constraints**: Must not break existing authentication flows
**Scale/Scope**: 3 files affected (2 deletions, 1 edit)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Gate | Status | Notes |
|------|--------|-------|
| Security (§3) | ✅ PASS | Removing XSS-vulnerable code aligns with security requirements |
| Testing (§7) | ✅ PASS | Deleting test file for deleted code is correct |
| Git Workflow (§8) | ✅ PASS | Will follow feature branch workflow |
| No bypasses | ✅ PASS | No pipeline bypasses required |

**No violations requiring justification.**

## Project Structure

### Documentation (this feature)

```text
specs/1145-delete-cookies-ts/
├── spec.md              # Feature specification
├── plan.md              # This file
├── research.md          # Not needed (simple deletion)
├── checklists/
│   └── requirements.md  # Quality checklist
└── tasks.md             # To be generated by /speckit.tasks
```

### Source Code (affected files)

```text
frontend/
├── src/
│   ├── lib/
│   │   └── cookies.ts           # DELETE - XSS vulnerability
│   └── stores/
│       └── auth-store.ts        # EDIT - remove cookies import/calls
└── tests/
    └── unit/
        └── lib/
            └── cookies.test.ts  # DELETE - tests deleted code
```

**Structure Decision**: Frontend-only change. Deleting 2 files, editing 1 file.

## Complexity Tracking

> No violations - simple file deletion operation.

| Aspect | Assessment |
|--------|------------|
| Files to delete | 2 (cookies.ts, cookies.test.ts) |
| Files to edit | 1 (auth-store.ts) |
| New patterns | None |
| Dependencies added | None |
| Risk level | Low (deletion reduces attack surface) |

## Phase 0: Research

**No research needed.** This is a straightforward file deletion with known dependencies:
- `cookies.ts` is imported by `auth-store.ts`
- `cookies.test.ts` tests `cookies.ts`
- Backend already handles httpOnly cookies

## Phase 1: Design

### Implementation Steps

1. **Delete `frontend/src/lib/cookies.ts`**
   - Remove entire file
   - This eliminates the XSS vulnerability

2. **Edit `frontend/src/stores/auth-store.ts`**
   - Remove import: `import { setAuthCookies, clearAuthCookies } from '@/lib/cookies';`
   - Remove all calls to `setAuthCookies()`
   - Remove all calls to `clearAuthCookies()`

3. **Delete `frontend/tests/unit/lib/cookies.test.ts`**
   - Remove test file for deleted functionality

4. **Verify build passes**
   - Run `npm run build` to ensure no TypeScript errors
   - Run `npm run test` to ensure remaining tests pass

### No Data Model Changes

This feature does not introduce new entities or modify data models.

### No API Contract Changes

This feature does not modify any APIs.
