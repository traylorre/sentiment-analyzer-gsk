{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "DevResourcesOnly",
            "Effect": "Allow",
            "Action": [
                "dynamodb:*",
                "lambda:*",
                "s3:*",
                "sns:*",
                "sqs:*",
                "secretsmanager:GetSecretValue",
                "secretsmanager:DescribeSecret",
                "secretsmanager:CreateSecret",
                "secretsmanager:UpdateSecret",
                "secretsmanager:DeleteSecret",
                "secretsmanager:PutSecretValue",
                "secretsmanager:TagResource",
                "events:*",
                "iam:*",
                "logs:*",
                "cloudwatch:*"
            ],
            "Resource": [
                "arn:aws:dynamodb:*:*:table/dev-*",
                "arn:aws:lambda:*:*:function:dev-*",
                "arn:aws:lambda:*:*:function:dev-*:*",
                "arn:aws:s3:::*-dev-*",
                "arn:aws:s3:::*-dev-*/*",
                "arn:aws:sns:*:*:dev-*",
                "arn:aws:sqs:*:*:dev-*",
                "arn:aws:secretsmanager:*:*:secret:dev/*",
                "arn:aws:secretsmanager:*:*:secret:dev/*-*",
                "arn:aws:events:*:*:rule/dev-*",
                "arn:aws:iam::*:role/dev-*",
                "arn:aws:iam::*:policy/dev-*",
                "arn:aws:logs:*:*:log-group:/aws/lambda/dev-*",
                "arn:aws:logs:*:*:log-group:/aws/lambda/dev-*:*",
                "arn:aws:cloudwatch:*:*:alarm:dev-*"
            ]
        },
        {
            "Sid": "SecretsManagerGlobalActions",
            "Effect": "Allow",
            "Action": [
                "secretsmanager:ListSecrets"
            ],
            "Resource": "*"
        },
        {
            "Sid": "TerraformStateAccess",
            "Effect": "Allow",
            "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:ListBucket"
            ],
            "Resource": [
                "arn:aws:s3:::sentiment-analyzer-tfstate-*",
                "arn:aws:s3:::sentiment-analyzer-tfstate-*/dev/*"
            ]
        },
        {
            "Sid": "TerraformLockAccess",
            "Effect": "Allow",
            "Action": [
                "dynamodb:GetItem",
                "dynamodb:PutItem",
                "dynamodb:DeleteItem",
                "dynamodb:DescribeTable"
            ],
            "Resource": "arn:aws:dynamodb:*:*:table/terraform-state-lock-dev"
        },
        {
            "Sid": "DenyPreprodResources",
            "Effect": "Deny",
            "Action": "*",
            "Resource": [
                "arn:aws:dynamodb:*:*:table/preprod-*",
                "arn:aws:lambda:*:*:function:preprod-*",
                "arn:aws:s3:::*-preprod-*",
                "arn:aws:s3:::*-preprod-*/*",
                "arn:aws:secretsmanager:*:*:secret:preprod/*",
                "arn:aws:iam::*:role/preprod-*"
            ]
        },
        {
            "Sid": "DenyProdResources",
            "Effect": "Deny",
            "Action": "*",
            "Resource": [
                "arn:aws:dynamodb:*:*:table/prod-*",
                "arn:aws:lambda:*:*:function:prod-*",
                "arn:aws:s3:::*-prod-*",
                "arn:aws:s3:::*-prod-*/*",
                "arn:aws:secretsmanager:*:*:secret:prod/*",
                "arn:aws:iam::*:role/prod-*"
            ]
        }
    ]
}
